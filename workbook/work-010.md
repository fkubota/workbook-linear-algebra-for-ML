### work-010

PCAの簡単な導出を行う。データ集合 $\{\bm{x}_n\} \ n=1, \dots , N$  を考える。$\bm{x}$ は $D$次元のデータ(特徴量が$D$個)であり、$D<N$ を仮定する。  

$$
\bm{x}_i = x_{i1}\bm{e}_1 + x_{i2}\bm{e}_2  + \dots + x_{iD}\bm{e}_D 
$$

ここで、$\{\bm{e}_j\}$ は正規直交基底とする。 以下で第一主成分を求める。

まず、$D$次元単位ベクトル $\bm{u}_1$ を考える。第一主成分とは、「データの分散が最大となる方向」であるので、$\bm{u}_1^T \bm{x}$ の分散が最大となるような$\bm{u}_1$を求めればよい。


1. $\bm{u}_1^T \bm{x}$ はどのような量か。説明せよ。


分散は
$$
\text{Var}(\bm{u}_1^T \bm{x}) = \frac{1}{N}\sum_i^N \{ \bm{u}_1^T\bm{x}_i - \bm{u}_1^T \overline{\bm{x}} \}^2 = \bm{u}_1^T \bf{\Sigma} \bm{u}_1
$$

となる。


ここで、$\overline{\bm{x}}$ は平均、$\bf{\Sigma}$ は共分散行列を表す。

2. $\overline{\bm{x}}$、$\bf{\Sigma}$ を書き下せ。
3. $\text{Var}(\bm{u}_1^T \bm{x}) = \bm{u}_1^T \bf{\Sigma}\bm{u}_1$  の計算過程を書け。


$\text{Var}(\bm{u}_1^T \bm{x}) $ を最大にする $\bm{u}_1$を求める。ラグランジュの未定乗数法を用いると$\bm{u}_1$の満たすべき条件式が以下になることがわかる。

$$
\bf{\Sigma}\bm{u}_1 = \lambda_1 \bm{u}_1
$$

4. ラグランジュの未定乗数法を用いて上式を導け。
5. $\bm{u}_1, \lambda_1$を求めよ。
5. 求めた$\bm{u}_1$の各成分はどのような意味を持つか？
6. $\bm{u}_1$ 方向の分散を求めよ。

以上が、第一主成分を求める手続きである。上記のような方法を繰り返すことで、第二、第三主成分も同様に求めることができる。

求めた主成分を用いて各$\bm{u}_i$方向にデータ$\bm{x}_n$を射影する。具体的には以下のように表現される。


$$
\begin{aligned}
    y_{n1} &=\bm{u}_1^T \bm{x}_n \\
    y_{n2} &=\bm{u}_2^T \bm{x}_n \\
    &\vdots \\
    y_{ni} &=\bm{u}_i^T \bm{x}_n \\
    &\vdots \\
    y_{nd} &=\bm{u}_d^T \bm{x}_n \\
\end{aligned}
$$


行列とベクトルで表現すれば、
$$
\begin{aligned}
    \bm{y}_n &= U^T\bm{x}_n \\ 
\end{aligned}
$$

となる。

8. 上式はどのような意味を持つか。説明せよ。